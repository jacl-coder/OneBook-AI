# OneBook AI Environment Variables
# Copy this file to .env and fill in your values.
# This file keeps only common local-development settings.
# For advanced options, see README.md.

# ===================
# Database
# ===================
DATABASE_URL=postgres://onebook:onebook@localhost:5432/onebook?sslmode=disable

# ===================
# Redis (refresh token + revoke state)
# ===================
REDIS_ADDR=localhost:6379
REDIS_PASSWORD=

# ===================
# JWT Authentication (RS256)
# ===================
# run.sh resolves relative paths from repo root and auto-generates keys if missing.
JWT_PRIVATE_KEY_PATH=secrets/jwt/private.pem
JWT_PUBLIC_KEY_PATH=secrets/jwt/public.pem
JWT_KEY_ID=jwt-active
JWT_ISSUER=onebook-auth
JWT_AUDIENCE=onebook-api
JWT_LEEWAY=30s

# ===================
# CORS (frontend dev server + cookie auth)
# ===================
CORS_ALLOWED_ORIGINS=http://localhost:5173,http://localhost:8086
CORS_ALLOW_CREDENTIALS=true

# ===================
# MinIO Object Storage
# ===================
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=onebook
MINIO_SECRET_KEY=onebook123
MINIO_BUCKET=onebook
MINIO_USE_SSL=false

# ===================
# Internal Service JWT (RS256)
# ===================
ONEBOOK_INTERNAL_JWT_PRIVATE_KEY_PATH=secrets/internal-jwt/private.pem
ONEBOOK_INTERNAL_JWT_PUBLIC_KEY_PATH=secrets/internal-jwt/public.pem
ONEBOOK_INTERNAL_JWT_KEY_ID=internal-active

# ===================
# Text Generation (LLM)
# ===================
# GENERATION_PROVIDER selects the generation backend:
#   gemini        – Google Gemini (default, needs GENERATION_API_KEY)
#   ollama        – local Ollama /api/chat
#   openai-compat – any OpenAI-compatible /v1/chat/completions endpoint
GENERATION_PROVIDER=gemini
GENERATION_API_KEY=your-api-key-here
GENERATION_MODEL=gemini-2.5-flash
# GENERATION_BASE_URL=http://localhost:8000/v1

# ===================
# Canonical Embedding Dimension
# ===================
ONEBOOK_EMBEDDING_DIM=3072

# ===================
# Ingest chunking
# ===================
INGEST_CHUNK_SIZE=800
INGEST_CHUNK_OVERLAP=120

# ===================
# Optional OCR fallback for scanned PDF (PaddleOCR CLI)
# ===================
INGEST_OCR_ENABLED=false
INGEST_OCR_COMMAND=paddleocr
INGEST_OCR_DEVICE=cpu
INGEST_OCR_TIMEOUT_SECONDS=120
INGEST_PDF_MIN_PAGE_RUNES=80
INGEST_PDF_MIN_PAGE_SCORE=0.45
INGEST_PDF_OCR_MIN_SCORE_DELTA=0.08

# ===================
# Ollama (local embedding provider)
# ===================
OLLAMA_HOST=http://127.0.0.1:11434
OLLAMA_EMBEDDING_MODEL=qwen3-embedding:latest
