# OneBook AI Environment Variables
# Copy this file to .env and fill in your values

# ===================
# Database
# ===================
DATABASE_URL=postgres://onebook:onebook@localhost:5432/onebook?sslmode=disable

# ===================
# Redis (required for refresh tokens + token revocation state)
# ===================
REDIS_ADDR=localhost:6379
REDIS_PASSWORD=

# ===================
# JWT Authentication
# ===================
# Preferred (production default): RS256
# For run.sh, relative paths are resolved from repo root and keys auto-generated if missing.
JWT_PRIVATE_KEY_PATH=secrets/jwt/private.pem
JWT_PUBLIC_KEY_PATH=secrets/jwt/public.pem
JWT_KEY_ID=jwt-active
# JWT_VERIFY_PUBLIC_KEYS=jwt-prev=./secrets/jwt/prev-public.pem
JWT_ISSUER=onebook-auth
JWT_AUDIENCE=onebook-api
JWT_LEEWAY=30s
# GATEWAY_AUTH_JWKS_URL=http://localhost:8081/auth/jwks
# BOOK_AUTH_JWKS_URL=http://localhost:8081/auth/jwks
# CHAT_AUTH_JWKS_URL=http://localhost:8081/auth/jwks
# AUTH_REFRESH_TTL=168h
# BOOK_AUTH_SERVICE_URL=http://localhost:8081
# CHAT_AUTH_SERVICE_URL=http://localhost:8081
# AUTH_SIGNUP_RATE_LIMIT_PER_MINUTE=5
# AUTH_LOGIN_RATE_LIMIT_PER_MINUTE=10
# AUTH_REFRESH_RATE_LIMIT_PER_MINUTE=20
# AUTH_PASSWORD_RATE_LIMIT_PER_MINUTE=10
# AUTH_TRUSTED_PROXY_CIDRS=10.0.0.0/8,192.168.0.0/16
# GATEWAY_SIGNUP_RATE_LIMIT_PER_MINUTE=5
# GATEWAY_LOGIN_RATE_LIMIT_PER_MINUTE=10
# GATEWAY_REFRESH_RATE_LIMIT_PER_MINUTE=20
# GATEWAY_PASSWORD_RATE_LIMIT_PER_MINUTE=10
# GATEWAY_TRUSTED_PROXY_CIDRS=10.0.0.0/8,192.168.0.0/16

# ===================
# CORS (optional, recommended for production)
# ===================
# Local Swagger UI runs at http://localhost:8086
# Vite dev server defaults to http://localhost:5173
# CORS_ALLOWED_ORIGINS=http://localhost:8086,http://localhost:5173
# CORS_ALLOWED_ORIGINS=https://app.example.com
CORS_ALLOW_CREDENTIALS=true

# ===================
# MinIO Object Storage
# ===================
MINIO_ENDPOINT=localhost:9000
MINIO_ACCESS_KEY=onebook
MINIO_SECRET_KEY=onebook123
MINIO_BUCKET=onebook
MINIO_USE_SSL=false

# ===================
# Internal Service Token
# ===================
# Preferred: RS256 short-lived internal service JWT (sign with private key, verify with public key)
ONEBOOK_INTERNAL_JWT_PRIVATE_KEY_PATH=secrets/internal-jwt/private.pem
ONEBOOK_INTERNAL_JWT_PUBLIC_KEY_PATH=secrets/internal-jwt/public.pem
ONEBOOK_INTERNAL_JWT_KEY_ID=internal-active
# ONEBOOK_INTERNAL_JWT_VERIFY_PUBLIC_KEYS=internal-prev=./secrets/internal-jwt/prev-public.pem

# ===================
# Gemini AI API
# ===================
GEMINI_API_KEY=your-gemini-api-key-here
GEMINI_GENERATION_MODEL=gemini-2.0-flash
GEMINI_EMBEDDING_MODEL=text-embedding-004

# ===================
# Canonical Embedding Dimension (single source)
# ===================
# Keep this aligned with the active embedding model/provider.
ONEBOOK_EMBEDDING_DIM=3072

# ===================
# Ollama (local embeddings)
# ===================
OLLAMA_HOST=http://127.0.0.1:11434
OLLAMA_EMBEDDING_MODEL=qwen3-embedding:latest

# ===================
# Indexer Embedding Performance (optional)
# ===================
# EMBEDDING_BATCH_SIZE=4
# EMBEDDING_CONCURRENCY=2

# ===================
# Service Ports (optional)
# ===================
# GATEWAY_PORT=8080
# AUTH_PORT=8081
# BOOK_PORT=8082
# CHAT_PORT=8083
# INGEST_PORT=8084
# INDEXER_PORT=8085
# CHAT_BOOK_SERVICE_URL=http://localhost:8082

# ===================
# Chat History (optional)
# ===================
# CHAT_HISTORY_LIMIT=6

# ===================
# Upload Limits (optional)
# ===================
# GATEWAY_MAX_UPLOAD_BYTES=52428800
# BOOK_MAX_UPLOAD_BYTES=52428800
# GATEWAY_ALLOWED_EXTENSIONS=.pdf,.epub,.txt
# BOOK_ALLOWED_EXTENSIONS=.pdf,.epub,.txt
