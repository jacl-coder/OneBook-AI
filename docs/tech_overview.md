# OneBook AI — 技术框架（简版）

## 栈概要
- 后端：Go（Gin/Fiber/Echo 均可，MVP 任选其一）。
- 数据库：Postgres + pgvector（存储元数据与向量）。
- 前端：React（Vite + React SPA，后续可迁移 Next.js）。
- 存储：本地文件系统保存原始书文件（后续可换对象存储）。
- 任务执行：Go 异步任务（简单 worker/队列处理上传与索引）。
- 鉴权：JWT（HMAC-SHA256，含 TTL，登录/注册下发，登出立即失效）。如需有状态会话，可切换为 Redis 实现。

## 核心组件
- 上传与校验：接收 PDF/EPUB/TXT，校验格式/大小，写文件存储，入任务队列。
- 解析与索引：文本抽取 → 清洗 → 分块（保留章节/页码元数据） → 嵌入 → 写入 pgvector。
- 对话服务：根据书 ID 检索相关 chunk，构造提示调用 LLM，返回回答与出处。
- 书库与状态：查询书列表、处理状态（排队/处理中/可对话/失败），删除书及衍生数据。
- 会话与历史：按书创建会话，保留最近若干轮消息。

## 外部/可替换接口
- LLM 接口：占位；可接本地模型或云 API（OpenAI/Claude 等）。
- Embedding 接口：占位；可接开源模型或云向量服务。

## 非功能基线
- 处理时长：常规书（几十到数百页）在可接受时间内完成，并有状态提示。
- 对话延迟：目标在几秒级返回，默认附出处信息。
- 安全提示：上传需提示版权自担，数据仅对本人可见。 
