<svg width="600" height="571" viewBox="-45 -25 600 571" fill="none" preserveAspectRatio="xMidYMid meet" xmlns="http://www.w3.org/2000/svg">
  <rect x="1" y="1" width="507" height="474" rx="6" fill="#FFFFFF" stroke="#D7DBDE" filter="url(#windowShadow)"/>
  <circle cx="18" cy="19" r="6" fill="#E96B5E"/>
  <circle cx="36" cy="19" r="6" fill="#E6B84B"/>
  <circle cx="54" cy="19" r="6" fill="#62C554"/>
  <text fill="#1F2328" xml:space="preserve" style="white-space: pre" font-family="Arial, sans-serif" font-size="12" font-weight="700" letter-spacing="0" text-anchor="middle">
    <tspan x="254.5" y="23.2">Retrieve</tspan>
  </text>

  <g transform="translate(3 3) scale(0.836)">
    <!-- Query input area -->
    <rect x="24" y="48" width="552" height="68" rx="8" fill="#FAFBFC" stroke="#E2E6EA"/>
    <text fill="#37424C" font-family="Arial, sans-serif" font-size="13" font-weight="600"><tspan x="40" y="74">User Query</tspan></text>
    <rect x="40" y="84" width="440" height="24" rx="6" fill="#FFFFFF" stroke="#DCE6EE"/>
    <text fill="#5A6772" font-family="Arial, sans-serif" font-size="11"><tspan x="52" y="100">"What are the main feature selection methods?"</tspan></text>
    <rect x="488" y="84" width="72" height="24" rx="6" fill="#3A8AC2"/>
    <text fill="#FFFFFF" font-family="Arial, sans-serif" font-size="10" font-weight="600" text-anchor="middle"><tspan x="524" y="100">Search</tspan></text>

    <!-- Vector space visualization -->
    <rect x="24" y="132" width="280" height="260" rx="8" fill="#F7FAFD" stroke="#DCE6EE"/>
    <text fill="#3A6B8C" font-family="Arial, sans-serif" font-size="12" font-weight="600"><tspan x="40" y="158">Vector Space</tspan></text>
    <text fill="#A0ABB5" font-family="Arial, sans-serif" font-size="9"><tspan x="200" y="158">cosine similarity</tspan></text>

    <!-- Query vector (star marker) -->
    <polygon points="152,230 156,242 168,242 158,250 162,262 152,254 142,262 146,250 136,242 148,242" fill="#3A8AC2" opacity="0.8"/>
    <text fill="#3A8AC2" font-family="Arial, sans-serif" font-size="8" font-weight="600"><tspan x="170" y="250">query</tspan></text>

    <!-- Close match dots (highlighted) -->
    <circle cx="172" cy="218" r="7" fill="#EEF5FB" stroke="#3A8AC2" stroke-width="1.5"/>
    <circle cx="138" cy="256" r="7" fill="#EEF5FB" stroke="#3A8AC2" stroke-width="1.5"/>
    <circle cx="176" cy="260" r="7" fill="#EEF5FB" stroke="#3A8AC2" stroke-width="1.5"/>

    <!-- Dashed lines to close matches -->
    <line x1="155" y1="235" x2="170" y2="222" stroke="#3A8AC2" stroke-width="1" stroke-dasharray="3 2" opacity="0.5"/>
    <line x1="148" y1="248" x2="140" y2="254" stroke="#3A8AC2" stroke-width="1" stroke-dasharray="3 2" opacity="0.5"/>
    <line x1="158" y1="250" x2="174" y2="258" stroke="#3A8AC2" stroke-width="1" stroke-dasharray="3 2" opacity="0.5"/>

    <!-- Distant dots (dimmed) -->
    <circle cx="80" cy="192" r="5" fill="#E8ECF0" stroke="#D1D5DB"/>
    <circle cx="240" cy="188" r="5" fill="#E8ECF0" stroke="#D1D5DB"/>
    <circle cx="96" cy="310" r="5" fill="#E8ECF0" stroke="#D1D5DB"/>
    <circle cx="220" cy="320" r="5" fill="#E8ECF0" stroke="#D1D5DB"/>
    <circle cx="60" cy="260" r="5" fill="#E8ECF0" stroke="#D1D5DB"/>
    <circle cx="260" cy="270" r="5" fill="#E8ECF0" stroke="#D1D5DB"/>
    <circle cx="120" cy="176" r="5" fill="#E8ECF0" stroke="#D1D5DB"/>
    <circle cx="200" cy="340" r="5" fill="#E8ECF0" stroke="#D1D5DB"/>
    <circle cx="280" cy="230" r="5" fill="#E8ECF0" stroke="#D1D5DB"/>

    <!-- Similarity scores legend -->
    <text fill="#3A8AC2" font-family="Arial, sans-serif" font-size="9"><tspan x="40" y="374">● 0.92</tspan></text>
    <text fill="#3A8AC2" font-family="Arial, sans-serif" font-size="9"><tspan x="100" y="374">● 0.88</tspan></text>
    <text fill="#3A8AC2" font-family="Arial, sans-serif" font-size="9"><tspan x="160" y="374">● 0.85</tspan></text>
    <text fill="#D1D5DB" font-family="Arial, sans-serif" font-size="9"><tspan x="220" y="374">○ &lt; 0.7</tspan></text>

    <!-- Arrow -->
    <g transform="translate(314, 260)">
      <line x1="0" y1="0" x2="24" y2="0" stroke="#A7B5C2" stroke-width="2" stroke-linecap="round"/>
      <polyline points="18,-5 24,0 18,5" fill="none" stroke="#A7B5C2" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
    </g>

    <!-- Retrieved results panel -->
    <rect x="348" y="132" width="228" height="260" rx="8" fill="#FAFBFC" stroke="#E2E6EA"/>
    <text fill="#37424C" font-family="Arial, sans-serif" font-size="12" font-weight="600"><tspan x="364" y="158">Top-K Results</tspan></text>
    <text fill="#62C554" font-family="Arial, sans-serif" font-size="10" font-weight="600"><tspan x="508" y="158">3 hits</tspan></text>

    <!-- Result 1 -->
    <rect x="360" y="170" width="204" height="70" rx="6" fill="#EEF5FB" stroke="#D7E5F2"/>
    <rect x="368" y="178" width="42" height="16" rx="4" fill="#3A8AC2"/>
    <text fill="#FFFFFF" font-family="Arial, sans-serif" font-size="8" font-weight="700"><tspan x="376" y="190">0.92</tspan></text>
    <text fill="#344B5F" font-family="Arial, sans-serif" font-size="10" font-weight="600"><tspan x="416" y="190">Chunk #7</tspan></text>
    <text fill="#6D7F8D" font-family="Arial, sans-serif" font-size="9"><tspan x="368" y="210">Feature selection methods include filter,</tspan></text>
    <text fill="#6D7F8D" font-family="Arial, sans-serif" font-size="9"><tspan x="368" y="222">wrapper, and embedded approaches…</tspan></text>
    <text fill="#8FA4B8" font-family="Arial, sans-serif" font-size="8"><tspan x="368" y="236">Ch.3 §3.1 pp.82-83</tspan></text>

    <!-- Result 2 -->
    <rect x="360" y="248" width="204" height="70" rx="6" fill="#EEF8F2" stroke="#D6EBDC"/>
    <rect x="368" y="256" width="42" height="16" rx="4" fill="#3A8AC2" opacity="0.8"/>
    <text fill="#FFFFFF" font-family="Arial, sans-serif" font-size="8" font-weight="700"><tspan x="376" y="268">0.88</tspan></text>
    <text fill="#355847" font-family="Arial, sans-serif" font-size="10" font-weight="600"><tspan x="416" y="268">Chunk #12</tspan></text>
    <text fill="#6B8577" font-family="Arial, sans-serif" font-size="9"><tspan x="368" y="288">Recursive feature elimination ranks</tspan></text>
    <text fill="#6B8577" font-family="Arial, sans-serif" font-size="9"><tspan x="368" y="300">features by importance scores…</tspan></text>
    <text fill="#8FA4B8" font-family="Arial, sans-serif" font-size="8"><tspan x="368" y="314">Ch.3 §3.4 pp.92-94</tspan></text>

    <!-- Result 3 -->
    <rect x="360" y="326" width="204" height="58" rx="6" fill="#FFF7EE" stroke="#F0DFCB"/>
    <rect x="368" y="334" width="42" height="16" rx="4" fill="#3A8AC2" opacity="0.6"/>
    <text fill="#FFFFFF" font-family="Arial, sans-serif" font-size="8" font-weight="700"><tspan x="376" y="346">0.85</tspan></text>
    <text fill="#66503A" font-family="Arial, sans-serif" font-size="10" font-weight="600"><tspan x="416" y="346">Chunk #3</tspan></text>
    <text fill="#8A725A" font-family="Arial, sans-serif" font-size="9"><tspan x="368" y="364">PCA as an unsupervised method…</tspan></text>
    <text fill="#8FA4B8" font-family="Arial, sans-serif" font-size="8"><tspan x="368" y="378">Ch.3 §3.2 pp.86-88</tspan></text>

    <!-- Bottom: Pipeline summary -->
    <rect x="24" y="408" width="552" height="140" rx="8" fill="#FAFBFC" stroke="#E2E6EA"/>
    <text fill="#37424C" font-family="Arial, sans-serif" font-size="13" font-weight="600"><tspan x="40" y="436">Retrieval Pipeline</tspan></text>

    <!-- Step boxes -->
    <rect x="40" y="450" width="108" height="40" rx="6" fill="#EEF5FB" stroke="#D7E5F2"/>
    <text fill="#344B5F" font-family="Arial, sans-serif" font-size="10" font-weight="600" text-anchor="middle"><tspan x="94" y="466">Encode Query</tspan></text>
    <text fill="#8FA4B8" font-family="Arial, sans-serif" font-size="8" text-anchor="middle"><tspan x="94" y="480">→ 768-dim vec</tspan></text>

    <path d="M152 470H168" stroke="#A7B5C2" stroke-width="1.5" stroke-linecap="round"/>
    <polyline points="164,466 168,470 164,474" fill="none" stroke="#A7B5C2" stroke-width="1.5" stroke-linecap="round"/>

    <rect x="172" y="450" width="108" height="40" rx="6" fill="#EEF8F2" stroke="#D6EBDC"/>
    <text fill="#355847" font-family="Arial, sans-serif" font-size="10" font-weight="600" text-anchor="middle"><tspan x="226" y="466">ANN Search</tspan></text>
    <text fill="#8FA4B8" font-family="Arial, sans-serif" font-size="8" text-anchor="middle"><tspan x="226" y="480">pgvector ivfflat</tspan></text>

    <path d="M284 470H300" stroke="#A7B5C2" stroke-width="1.5" stroke-linecap="round"/>
    <polyline points="296,466 300,470 296,474" fill="none" stroke="#A7B5C2" stroke-width="1.5" stroke-linecap="round"/>

    <rect x="304" y="450" width="108" height="40" rx="6" fill="#FFF7EE" stroke="#F0DFCB"/>
    <text fill="#66503A" font-family="Arial, sans-serif" font-size="10" font-weight="600" text-anchor="middle"><tspan x="358" y="466">Rank + Filter</tspan></text>
    <text fill="#8FA4B8" font-family="Arial, sans-serif" font-size="8" text-anchor="middle"><tspan x="358" y="480">score ≥ 0.7</tspan></text>

    <path d="M416 470H432" stroke="#A7B5C2" stroke-width="1.5" stroke-linecap="round"/>
    <polyline points="428,466 432,470 428,474" fill="none" stroke="#A7B5C2" stroke-width="1.5" stroke-linecap="round"/>

    <rect x="436" y="450" width="124" height="40" rx="6" fill="#F4F1FC" stroke="#E2DAF2"/>
    <text fill="#4A4366" font-family="Arial, sans-serif" font-size="10" font-weight="600" text-anchor="middle"><tspan x="498" y="466">Return Top-K</tspan></text>
    <text fill="#8FA4B8" font-family="Arial, sans-serif" font-size="8" text-anchor="middle"><tspan x="498" y="480">with metadata</tspan></text>

    <text fill="#A0ABB5" font-family="Arial, sans-serif" font-size="10" text-anchor="middle"><tspan x="300" y="534">latency: ~45ms · book_id scoped · source metadata preserved</tspan></text>
  </g>

  <defs>
    <filter id="windowShadow" x="-120" y="-120" width="920" height="920" filterUnits="userSpaceOnUse" color-interpolation-filters="sRGB">
      <feDropShadow dx="0" dy="16" stdDeviation="18" flood-color="#000000" flood-opacity="0.18"/>
    </filter>
  </defs>
</svg>
